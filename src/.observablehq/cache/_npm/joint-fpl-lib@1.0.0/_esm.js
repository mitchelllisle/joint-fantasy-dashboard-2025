/**
 * Bundled by jsDelivr using Rollup v2.79.2 and Terser v5.39.0.
 * Original file: /npm/joint-fpl-lib@1.0.0/dist/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
class t{draftBaseUrl="https://draft.premierleague.com/api";baseUrl="https://fantasy.premierleague.com/api";async getBootstrapStatic(){const t=await fetch(`${this.baseUrl}/bootstrap-static/`);if(!t.ok)throw new Error(`Failed to fetch bootstrap-static: ${t.statusText}`);return t.json()}async getDetails(t){const e=await fetch(`${this.draftBaseUrl}/league/${t}/details`);if(!e.ok)throw new Error(`Failed to fetch league details: ${e.statusText}`);return e.json()}async getUserHistory(t){const e=await fetch(`${this.draftBaseUrl}/entry/${t}/history`);if(!e.ok)throw new Error(`Failed to fetch user history: ${e.statusText}`);return e.json()}async getPicks(t,e){const n=await fetch(`${this.draftBaseUrl}/entry/${t}/event/${e}`);if(!n.ok)throw new Error(`Failed to fetch picks: ${n.statusText}`);return n.json()}async getMatchResults(t){const e=await this.getDetails(t),n=e.standings,o=e.league_entries,a=(await Promise.all(n.map((async t=>{const e=o.find((e=>e.id===t.league_entry));if(!e)return[];return((await this.getUserHistory(e.entry_id)).history||[]).map((t=>({gameweek:t.event,player_first_name:e.player_first_name,team:e.entry_name,total:t.total_points,points:t.points,entry_id:e.entry_id,rank:0})))})))).flat();if(0===a.length)return{title:"No Data",sentence:"No gameweek data available yet.",data:[]};const r=[...new Set(a.map((t=>t.gameweek)))],i=[];for(const t of r){a.filter((e=>e.gameweek===t)).sort(((t,e)=>e.total-t.total)).forEach(((t,e)=>{i.push({...t,rank:e+1})}))}return{title:`Gameweek ${Math.max(...i.map((t=>t.gameweek)))} Standings`,sentence:"Latest standings from the draft league.",data:i}}async getStandings(t){const e=await this.getDetails(t),n=e.league_entries;return e.standings.map((t=>({id:t.league_entry,name:n.find((e=>e.id===t.league_entry))?.entry_name||"",user:n.find((e=>e.id===t.league_entry))?.player_first_name||"",rank:t.rank,total:t.total,event_total:t.event_total,last_rank:t.last_rank})))}async getSquads(t){const e=await this.getDetails(t),n=await this.getBootstrapStatic(),o=n.events.find((t=>t.is_current)),a=o?o.id:1,r={};n.elements.forEach((t=>{r[t.id]={...t,web_name:t.web_name||`${t.first_name} ${t.second_name}`}}));return(await Promise.all(e.league_entries.map((async t=>{try{return(await this.getPicks(t.entry_id,a)).picks.map((e=>{const n=r[e.element];return n?{...n,owner:t.entry_name,team_name:t.entry_name,position:e.position}:null})).filter((t=>null!==t))}catch(e){return console.error(`Error fetching picks for ${t.player_first_name}:`,e),[]}})))).flat()}}const e={domain:["Thrillhouse","youngsandwich","Not the Wirtz Team","Endo Days"],range:["#00ff85","#e90052","#963cff","#04f5ff"]};function n(t,{Plot:n,d3:a,x:r="gameweek",y:i="rank",z:s="team",width:l}={}){const c=n.stackY2({x:r,z:s,order:i}),[d,m]=a.extent(n.valueof(t,r));return n.plot({title:"Rank Across Gameweeks",subtitle:"Shows the rankings as they change throughout the season",width:l,marginLeft:100,marginRight:100,x:{[l<480?"insetRight":"inset"]:30,label:null,grid:!0},y:{axis:null,inset:20,reverse:!0},color:e,marks:[n.lineY(t,{...c,stroke:s,strokeWidth:26,curve:"bump-x",sort:{color:"y",reduce:"first"},render:o({stroke:"var(--theme-background-alt)",strokeWidth:33})}),n.text(t,{...c,text:c.y,fill:"black",stroke:s,tip:!0}),l<480?null:n.text(t,{...c,filter:t=>t[r]<=d,text:s,dx:-20,textAnchor:"end"}),n.text(t,{...c,filter:t=>t[r]>=m,text:s,dx:20,textAnchor:"start"})]})}function o({stroke:t="currentColor",strokeWidth:e=3}={}){return(n,o,a,r,i,s)=>{const l=s(n,o,a,r,i);for(const n of[...l.childNodes]){const o=n.cloneNode(!0);o.setAttribute("stroke",t),o.setAttribute("stroke-width",e),n.parentNode.insertBefore(o,n)}return l}}function a(t){if(0===t.length)return 0;if(1===t.length)return 0;const e=[...t].sort(((t,e)=>t-e)),n=e.length,o=e.reduce(((t,e)=>t+e),0);if(0===o)return 0;let a=0;for(let t=0;t<n;t++)a+=(t+1)*e[t];return 2*a/(n*o)-(n+1)/n}function r(t,e,n="No data available"){return 0===t.length?[e.text([n],{frameAnchor:"middle",fontSize:16,fill:"#999"})]:[]}function i(t,{Plot:n,d3:o,width:i}={}){console.log("Gini chart - input data length:",t.length);const s=t.filter((t=>null!==t.owner));console.log("Gini chart - owned data length:",s.length);const l={};s.forEach((t=>{l[t.owner]||(l[t.owner]={owner:t.owner,points:[],maxPoints:0}),l[t.owner].points.push(t.total_points),l[t.owner].maxPoints=Math.max(l[t.owner].maxPoints,t.total_points)}));const c=Object.values(l).map((t=>({owner:t.owner,gini:100*a(t.points),maxPoints:t.maxPoints})));return console.log("Gini chart - giniData:",c),n.plot({title:"Gini Index by Owner",subtitle:"A measure of inequality in points scored. 0% = perfectly equal, 100 = one player has all the points. The lower the score, the more players are contributing the points. Size of hexagon represents max points scored by a single player.",width:i,height:500,color:{...e,legend:!1},y:{domain:[0,100],label:"Gini Index"},x:{label:null},r:{range:[5,20]},marginTop:40,marginLeft:80,marks:[n.hexagon(c,n.dodgeX({y:"gini",r:"maxPoints",fill:"owner",tip:!0,fillOpacity:.8,strokeWidth:10})),...r(c,n)]})}function s(t,{Plot:n,d3:o,width:a}={}){const r=t.filter((t=>t.minutes>0)),i=r.filter((t=>t.bonus>10)).sort(((t,e)=>e.bonus-t.bonus)).slice(0,10);return n.plot({title:"Bonus Points vs Total Points",subtitle:"Scatter plot showing all players. Owned players highlighted by team. Contours show player density.",width:a,height:500,x:{label:"Total Points"},y:{label:"Bonus Points"},color:{...e,legend:!0},marks:[n.density(r,{x:"total_points",y:"bonus",stroke:"#ccc",strokeOpacity:.5,strokeWidth:2,thresholds:5}),n.dot(r.filter((t=>!t.owner)),{x:"total_points",y:"bonus",fill:"#ddd",r:3,opacity:.3}),n.dot(r.filter((t=>t.owner)),{x:"total_points",y:"bonus",fill:"owner",stroke:"owner",strokeWidth:1.5,r:6,tip:!0,channels:{Player:"web_name",Team:"owner",Bonus:"bonus",Points:"total_points",Minutes:"minutes"}}),n.text(i,{x:"total_points",y:"bonus",text:"web_name",dy:-10,fontSize:9,fontWeight:"bold"})]})}function l(t,{Plot:n,d3:o,width:a}={}){const r=t.filter((t=>t.position>11)),i={};r.forEach((t=>{i[t.owner]||(i[t.owner]={owner:t.owner,points:0,count:0}),i[t.owner].points+=t.event_points||0,i[t.owner].count+=1}));const s=Object.values(i);return n.plot({title:"Points Left on Bench",subtitle:"Total points scored by benched players this gameweek",width:a,marginLeft:120,x:{label:"Points on Bench"},y:{label:null},color:{...e,legend:!1},marks:[n.barX(s,{x:"points",y:"owner",fill:"owner",tip:!0,sort:{y:"-x"}}),n.text(s,{x:"points",y:"owner",text:t=>t.points,dx:15,textAnchor:"start"})]})}function c(t,{Plot:n,d3:o,width:a}={}){const r={};t.forEach((t=>{r[t.team]||(r[t.team]={team:t.team,points:[],best:-1/0,worst:1/0}),r[t.team].points.push(t.points),r[t.team].best=Math.max(r[t.team].best,t.points),r[t.team].worst=Math.min(r[t.team].worst,t.points)}));const i=Object.values(r).map((t=>{const e=o.mean(t.points),n=o.deviation(t.points);return{team:t.team,mean:e,stdDev:n,best:t.best,worst:t.worst,consistencyScore:100-n/e*100}})),s=o.max(i,(t=>t.best)),l=o.min(i,(t=>t.worst))-5;return n.plot({title:"Consistency & Performance Range",subtitle:"Best/worst gameweek with average shown. Shorter bars = more consistent",width:a,marginLeft:120,x:{label:"Points",domain:[l,s]},y:{label:null},color:{...e,legend:!1},marks:[n.barX(i,{x1:"worst",x2:"best",y:"team",fill:"team",fillOpacity:.2}),n.tickX(i,{x:"mean",y:"team",stroke:"team",strokeWidth:4}),n.dot(i,{x:"best",y:"team",fill:"team",r:5}),n.dot(i,{x:"worst",y:"team",fill:"team",r:5}),n.tip(i,n.pointer({x:"mean",y:"team",title:t=>`${t.team}\nBest: ${t.best}\nAvg: ${t.mean.toFixed(1)}\nWorst: ${t.worst}\nStd Dev: ${t.stdDev.toFixed(1)}`}))]})}function d(t,{Plot:e,d3:n,width:o}={}){const a=n.max(t,(t=>t.gameweek)),r=t.filter((t=>t.gameweek>a-5));return e.plot({title:"Last 5 Gameweeks Form",subtitle:"Position finished each gameweek. 1 = First place, 4 = Last place.",width:o,height:180,marginLeft:120,marginRight:60,x:{label:"Gameweek",tickFormat:t=>`GW${t}`,domain:n.range(a-4,a+1),padding:0},y:{label:null,padding:0},color:{type:"ordinal",domain:[1,2,3,4],range:["#10b981","#fbbf24","#f97316","#ef4444"],legend:!0,label:"Position"},marks:[e.cell(r,{x:"gameweek",y:"team",fill:"rank",tip:!0,inset:0}),e.text(r,{x:"gameweek",y:"team",text:t=>1===t.rank?"1st":2===t.rank?"2nd":3===t.rank?"3rd":"4th",fill:"white",fontWeight:"bold",fontSize:11})]})}function m(t,{Plot:n,d3:o,width:a}={}){const i="gameweek",s="points",l="team";let c;return 1===new Set(t.map((t=>t.team))).size&&(c=n.lineY(t,n.windowY(5,{x:i,y:s,curve:"cardinal",stroke:"white"}))),n.plot({title:"Score per Gameweek",subtitle:"Shows the total score for each player over the course of the season",style:"overflow: visible;",width:a,y:{grid:!0},color:{...e,legend:!0},marks:[n.ruleY([0]),n.barY(t,{x:i,y:s,fill:l,order:l,tip:!0}),c,...r(t,n)]})}function h(t,{Plot:n,d3:o,width:a}={}){const i="gameweek",s="total",l="team";return n.plot({title:"Points per Gameweek",subtitle:"Shows a cumulative points total for each player over the course of the season",style:"overflow: visible;",width:a,y:{grid:!0},color:{...e,legend:!0},marks:[n.ruleY([0]),n.axisY({label:"Points"}),n.axisX({label:"Gameweek"}),n.lineY(t,{x:i,y:s,stroke:l,curve:"natural",marker:"circle-stroke",tip:!0}),n.text(t,n.selectLast({x:i,y:s,z:l,text:l,textAnchor:"start",dx:3})),...r(t,n)]})}function u(t,{Plot:e,d3:n,width:o}={}){const a=t.filter((t=>t.position<=11)),r={1:"GK",2:"DEF",3:"MID",4:"FWD"},i={};a.forEach((t=>{const e=`${t.owner}_${t.element_type}`;i[e]||(i[e]={owner:t.owner,position:r[t.element_type]||"Unknown",points:0}),i[e].points+=t.total_points||0}));const s=Object.values(i);return e.plot({title:"Points by Position",subtitle:"Total season points contribution by position (starting XI only)",width:o,marginLeft:120,x:{label:"Total Points"},y:{label:null},color:{domain:["GK","DEF","MID","FWD"],range:["#e90052","#963cff","#04f5ff","#00ff85"],legend:!0},marks:[e.barX(s,e.stackX({x:"points",y:"owner",fill:"position",tip:!0,sort:{y:"-x",reduce:"sum"}})),e.ruleX([0])]})}export{t as PremierLeagueAPI,l as benchPoints,s as bonusPoints,n as bumpChart,a as calculateGini,e as colours,c as consistencyBullet,d as formChart,i as giniIndexChart,r as noDataTextMark,m as pointsBarChart,h as pointsPerWeek,u as positionBreakdown};export default null;
